<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Enhanced Course Viewer</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <style>
        /* Modern CSS Reset and Variables */
:root {
    /* Color System */
    --primary: #6366f1;
    --primary-hover: #4f46e5;
    --secondary: #7c3aed;
    --secondary-hover: #6d28d9;
    --success: #10b981;
    --warning: #f59e0b;
    --danger: #ef4444;
    --gray-50: #f8fafc;
    --gray-100: #f1f5f9;
    --gray-200: #e2e8f0;
    --gray-300: #cbd5e1;
    --gray-400: #94a3b8;
    --gray-500: #64748b;
    --gray-600: #475569;
    --gray-700: #334155;
    --gray-800: #1e293b;
    --gray-900: #0f172a;

    /* Gradients */
    --gradient-primary: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
    --gradient-secondary: linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%);
    --gradient-background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
    --gradient-card: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.8) 100%);

    /* Shadows */
    --shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
    --shadow-inner: inset 0 2px 4px 0 rgb(0 0 0 / 0.05);
    --shadow-colored: 0 10px 15px -3px var(--shadow-color), 0 4px 6px -4px var(--shadow-color);

    /* Layout */
    --sidebar-width: 300px;
    --header-height: 64px;
    --border-radius-sm: 0.375rem;
    --border-radius-md: 0.5rem;
    --border-radius-lg: 0.75rem;
    --border-radius-xl: 1rem;
    --border-radius-2xl: 1.5rem;
    --border-radius-full: 9999px;

    /* Typography */
    --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace;
    
    /* Transitions */
    --transition-all: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-transform: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-opacity: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-colors: background-color 0.3s cubic-bezier(0.4, 0, 0.2, 1), border-color 0.3s cubic-bezier(0.4, 0, 0.2, 1), color 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Animations */
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes slideIn {
    from { transform: translateX(-20px); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

@keyframes scaleIn {
    from { transform: scale(0.95); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}

@keyframes pulseGlow {
    0% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.4); }
    70% { box-shadow: 0 0 0 10px rgba(99, 102, 241, 0); }
    100% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0); }
}

@keyframes shimmer {
    0% { background-position: -1000px 0; }
    100% { background-position: 1000px 0; }
}

/* Base Styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

html {
    font-size: 16px;
    line-height: 1.5;
    -webkit-text-size-adjust: 100%;
}

body {
    font-family: var(--font-sans);
    background: var(--gradient-background);
    color: var(--gray-800);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

/* Header Styles */
.header {
    height: var(--header-height);
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-bottom: 1px solid rgba(226, 232, 240, 0.8);
    padding: 0 2rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 50;
    animation: fadeIn 0.5s ease-out;
}

.header-title {
    font-size: 1.25rem;
    font-weight: 600;
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.header-actions {
    display: flex;
    gap: 1rem;
    align-items: center;
}

/* Main Container */
.main-container {
    position: relative;
    display: grid;
    grid-template-columns: var(--sidebar-width) 1fr;
    height: calc(100vh - var(--header-height));
    margin-top: var(--header-height);
    gap: 1.5rem;
    padding: 1.5rem;
    transition: var(--transition-all);
}

/* Sidebar Styles */
.sidebar {
    background: var(--gradient-card);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-radius: var(--border-radius-xl);
    border: 1px solid rgba(226, 232, 240, 0.8);
    overflow: auto;
    overflow-x: hidden;
    display: flex;
    flex-direction: column;
    position: relative;
    min-width: 50px;
    max-width: 800px;
    box-shadow: var(--shadow-lg);
    transition: var(--transition-all);
}

.sidebar-content {
    padding: 1.5rem;
    overflow-y: auto;
    height: 100%;
}

.sidebar-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1.5rem;
}

/* Search Component */
.search-container {
    position: relative;
    margin-bottom: 2rem;
    animation: fadeIn 0.4s ease-out;
}

.search-container i {
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--gray-400);
    pointer-events: none;
    transition: var(--transition-colors);
}

#search {
    width: 100%;
    padding: 1rem 1rem 1rem 3rem;
    border: 2px solid var(--gray-200);
    border-radius: var(--border-radius-lg);
    background: rgba(255, 255, 255, 0.8);
    font-size: 0.875rem;
    transition: var(--transition-all);
}

#search:focus {
    outline: none;
    border-color: var(--primary);
    background: white;
    box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
}

#search:focus + i {
    color: var(--primary);
}

/* Folder Structure */
.folder {
    margin: 0.75rem 0;
    animation: slideIn 0.3s ease-out forwards;
    opacity: 0;
}

.folder-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.875rem 1rem;
    cursor: pointer;
    border-radius: var(--border-radius-lg);
    transition: var(--transition-all);
    background: transparent;
}

.folder-header:hover {
    background: rgba(241, 245, 249, 0.8);
    transform: translateX(4px);
}

.folder-header i {
    color: var(--gray-500);
    transition: var(--transition-all);
}

.folder.open .folder-header i {
    transform: rotate(90deg);
    color: var(--primary);
}

.folder-content {
    margin-left: 2rem;
    display: none;
    opacity: 0;
    transition: var(--transition-all);
}

.folder.open > .folder-content {
    display: block;
    opacity: 1;
}

/* File Items */
.file {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.875rem 1rem;
    cursor: pointer;
    border-radius: var(--border-radius-lg);
    color: var(--gray-600);
    transition: var(--transition-all);
    position: relative;
    overflow: hidden;
}

.file:before {
    content: counter(folder-counter, decimal-leading-zero);
    min-width: 2.5rem;
    color: var(--gray-400);
    font-family: var(--font-mono);
    font-size: 0.875rem;
    opacity: 0.8;
}

.file:hover {
    background: rgba(241, 245, 249, 0.8);
    color: var(--primary);
    transform: translateX(4px);
}

.file.active {
    background: rgba(99, 102, 241, 0.1);
    color: var(--primary);
    font-weight: 500;
}

.file.active:before {
    color: var(--primary);
    opacity: 1;
}

.file-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2rem;
    height: 2rem;
    border-radius: var(--border-radius-md);
    background: rgba(99, 102, 241, 0.1);
    color: var(--primary);
    transition: var(--transition-all);
}

.file:hover .file-icon {
    transform: scale(1.1);
    background: var(--primary);
    color: white;
}

/* Content Viewer */
.viewer-container {
    background: white;
    border-radius: var(--border-radius-2xl);
    box-shadow: var(--shadow-xl);
    padding: 2rem;
    height: 100%;
    animation: scaleIn 0.4s ease-out;
}

.viewer-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
    padding-bottom: 1.5rem;
    border-bottom: 1px solid var(--gray-200);
}

.path {
    font-size: 0.875rem;
    color: var(--gray-500);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.path i {
    font-size: 0.75rem;
    color: var(--gray-400);
}

/* Media Players */
video {
    width: 100%;
    border-radius: var(--border-radius-xl);
    background: black;
    box-shadow: var(--shadow-lg);
}

.pdf-container {
    width: 100%;
    height: calc(100% - 100px);
    border-radius: var(--border-radius-xl);
    overflow: hidden;
    box-shadow: var(--shadow-lg);
}

iframe {
    width: 100%;
    height: calc(100% - 100px);
    border-radius: var(--border-radius-xl);
    border: none;
    box-shadow: var(--shadow-lg);
}

/* Controls */
.controls {
    display: flex;
    gap: 1rem;
    align-items: center;
    margin-top: 1.5rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--gray-200);
}

button {
    padding: 0.875rem 1.5rem;
    border: none;
    border-radius: var(--border-radius-lg);
    background: var(--gradient-primary);
    color: white;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    transition: var(--transition-all);
    box-shadow: var(--shadow-md);
}

button:not(:disabled):hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

button:disabled {
    background: var(--gray-300);
    cursor: not-allowed;
    transform: none;
}

/* Resize Handler */
.resize-handle {
    position: absolute;
    right: -5px;
    top: 0;
    bottom: 0;
    width: 10px;
    cursor: col-resize;
    background: transparent;
    transition: var(--transition-all);
    z-index: 20;
}

.resize-handle:hover {
    background: rgba(99, 102, 241
    </style>
</head>
<body>
    <div class="header">
        <h1>Enhanced Course Viewer</h1>
    </div>
    <div class="main-container">
        <div class="sidebar">
            <div class="search-container">
                <i class="fas fa-search"></i>
                <input type="text" id="search" placeholder="Search files...">
            </div>
            <div id="fileTree"></div>
            <div class="settings">
                <label>
                    Playback Speed:
                    <select id="playbackSpeed">
                        <option value="0.5">0.5x</option>
                        <option value="0.75">0.75x</option>
                        <option value="1" selected>1x</option>
                        <option value="1.25">1.25x</option>
                        <option value="1.5">1.5x</option>
                        <option value="2">2x</option>
                    </select>
                </label>
                <label>
                    Autoplay Next:
                    <input type="checkbox" id="autoplay">
                </label>
                <label>
                    Dark Mode:
                    <input type="checkbox" id="darkMode">
                </label>
                <div class="progress-container">
                    <div class="progress-bar"></div>
                </div>
            </div>
        </div>
        <div class="content">
            <div class="viewer-container">
                <div class="viewer-header">
                    <div id="path" class="path"></div>
                    <button id="fullscreen">
                        <i class="fas fa-expand"></i>
                        Full Screen
                    </button>
                </div>
                <div id="viewer">
                    <video id="player" controls>
                        Your browser doesn't support video playback.
                    </video>
                </div>
                <div class="controls">
                    <button id="prev" disabled>
                        <i class="fas fa-step-backward"></i>
                        Previous
                    </button>
                    <button id="next" disabled>
                        <i class="fas fa-step-forward"></i>
                        Next
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize PDF.js
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        const fileInput = document.createElement('input');
        fileInput.type = 'file';
        fileInput.webkitdirectory = true;
        
        let currentFile = null;
        let fileList = [];
        let pdfDoc = null;
        
        function createFileTree(files) {
            const tree = {};
            files.forEach(file => {
                const parts = file.webkitRelativePath.split('/');
                let current = tree;
                parts.forEach((part, i) => {
                    if (i === parts.length - 1) {
                        if (part.match(/\.(mp4|webm|pdf|html)$/i)) {
                            current[part] = file;
                        }
                    } else {
                        current[part] = current[part] || {};
                        current = current[part];
                    }
                });
            });
            return tree;
        }
        
        function getFileIcon(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            switch(ext) {
                case 'mp4':
                case 'webm':
                    return 'fa-play-circle';
                case 'pdf':
                    return 'fa-file-pdf';
                case 'html':
                    return 'fa-file-code';
                default:
                    return 'fa-file';
            }
        }
        
        function renderTree(container, structure, path = '') {
            for (const [name, content] of Object.entries(structure)) {
                if (content instanceof File) {
                    const file = document.createElement('div');
                    file.className = 'file';
                    file.innerHTML = `
                        <div class="file-icon">
                            <i class="fas ${getFileIcon(name)}"></i>
                        </div>
                        <span>${name}</span>
                    `;
                    file.onclick = () => openFile(content);
                    container.appendChild(file);
                    fileList.push(content);
                } else {
                    const folder = document.createElement('div');
                    folder.className = 'folder';
                    const header = document.createElement('div');
                    header.className = 'folder-header';
                    header.innerHTML = `
                        <i class="fas fa-folder"></i>
                        <span>${name}</span>
                    `;
                    const content_div = document.createElement('div');
                    content_div.className = 'folder-content';
                    
                    header.onclick = () => {
                        folder.classList.toggle('open');
                        header.querySelector('i').classList.toggle('fa-folder');
                        header.querySelector('i').classList.toggle('fa-folder-open');
                    };
                    
                    folder.appendChild(header);
                    folder.appendChild(content_div);
                    container.appendChild(folder);
                    renderTree(content_div, content, path + '/' + name);
                }
            }
        }
        
        async function openFile(file) {
            const url = URL.createObjectURL(file);
            const viewer = document.getElementById('viewer');
            const ext = file.name.split('.').pop().toLowerCase();
            
            switch(ext) {
                case 'mp4':
                case 'webm':
                    viewer.innerHTML = `
                        <video id="player" controls>
                            <source src="${url}" type="video/${ext}">
                        </video>
                    `;
                    const player = document.getElementById('player');
                    player.playbackRate = document.getElementById('playbackSpeed').value;
                    player.play();
                    break;
                    
                case 'pdf':
                    viewer.innerHTML = '<div class="pdf-container" id="pdfContainer"></div>';
                    const loadingTask = pdfjsLib.getDocument(url);
                    pdfDoc = await loadingTask.promise;
                    renderPdfPage(1);
                    break;
                    
                case 'html':
                    viewer.innerHTML = `<iframe src="${url}"></iframe>`;
                    break;
            }
            
            currentFile = file;
            document.getElementById('path').textContent = file.webkitRelativePath;
            
            updateNavButtons();
            saveProgress();
            highlightCurrent();
        }
        
        async function renderPdfPage(pageNumber) {
            const page = await pdfDoc.getPage(pageNumber);
            const canvas = document.createElement('canvas');
            const container = document.getElementById('pdfContainer');
            const scale = 1.5;
            
            const viewport = page.getViewport({ scale });
            canvas.height = viewport.height;
            canvas.width = viewport.width;
            
            const context = canvas.getContext('2d');
            const renderContext = {
                canvasContext: context,
                viewport: viewport
            };
            
            container.innerHTML = '';
            container.appendChild(canvas);
            await page.render(renderContext);
        }

        function updateNavButtons() {
            const index = fileList.indexOf(currentFile);
            document.getElementById('prev').disabled = index <= 0;
            document.getElementById('next').disabled = index >= fileList.length - 1;
        }
        
        function highlightCurrent() {
            document.querySelectorAll('.file').forEach(f => f.classList.remove('active'));
            const files = document.querySelectorAll('.file');
            const index = fileList.indexOf(currentFile);
            files[index]?.classList.add('active');
        }
        
        function saveProgress() {
            const progress = {};
            const player = document.getElementById('player');
            if (player) {
                progress[currentFile.webkitRelativePath] = player.currentTime;
            }
            localStorage.setItem('videoProgress', JSON.stringify(progress));
        }
        
        function loadProgress() {
            return JSON.parse(localStorage.getItem('videoProgress') || '{}');
        }
        
        // Event Listeners
        document.getElementById('playbackSpeed').onchange = (e) => {
            const player = document.getElementById('player');
            if (player) {
                player.playbackRate = e.target.value;
            }
        };
        
        document.getElementById('prev').onclick = () => {
            const index = fileList.indexOf(currentFile);
            if (index > 0) openFile(fileList[index - 1]);
        };
        
        document.getElementById('next').onclick = () => {
            const index = fileList.indexOf(currentFile);
            if (index < fileList.length - 1) openFile(fileList[index + 1]);
        };
        
        document.getElementById('darkMode').onchange = (e) => {
            document.body.style.setProperty('--primary', e.target.checked ? '#60a5fa' : '#2563eb');
            document.body.style.backgroundColor = e.target.checked ? '#1a1a1a' : '#f8fafc';
            document.querySelectorAll('.sidebar, .header, .viewer-container').forEach(el => {
                el.style.backgroundColor = e.target.checked ? '#262626' : 'white';
                el.style.color = e.target.checked ? '#e5e5e5' : '#1e293b';
            });
        };

        document.getElementById('fullscreen').onclick = () => {
            const viewer = document.getElementById('viewer');
            if (viewer.requestFullscreen) {
                viewer.requestFullscreen();
            } else if (viewer.webkitRequestFullscreen) {
                viewer.webkitRequestFullscreen();
            }
        };

        // Video progress tracking
        const player = document.getElementById('player');
        if (player) {
            player.ontimeupdate = () => {
                const progress = (player.currentTime / player.duration) * 100;
                document.querySelector('.progress-bar').style.width = `${progress}%`;
                saveProgress();
            };

            player.onended = () => {
                if (document.getElementById('autoplay').checked) {
                    document.getElementById('next').click();
                }
            };
        }
        
        document.getElementById('search').oninput = (e) => {
            const term = e.target.value.toLowerCase();
            document.querySelectorAll('.file').forEach(file => {
                const visible = file.textContent.toLowerCase().includes(term);
                file.style.display = visible ? 'flex' : 'none';
                
                // Show parent folders of matching files
                let parent = file.parentElement;
                while (parent && parent.classList.contains('folder-content')) {
                    parent.parentElement.style.display = visible ? 'block' : null;
                    if (visible) parent.parentElement.classList.add('open');
                    parent = parent.parentElement.parentElement;
                }
            });
        };
        
        // Drag and drop functionality
        const dropZone = document.body;
        
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.style.opacity = '0.5';
        });
        
        dropZone.addEventListener('dragleave', () => {
            dropZone.style.opacity = '1';
        });
        
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.style.opacity = '1';
            
            const items = e.dataTransfer.items;
            if (items) {
                const files = [];
                let totalFiles = 0;
                let processedFiles = 0;
                
                function processEntry(entry) {
                    if (entry.isFile) {
                        entry.file(file => {
                            files.push(file);
                            processedFiles++;
                            if (processedFiles === totalFiles) {
                                const tree = createFileTree(files);
                                const container = document.getElementById('fileTree');
                                container.innerHTML = '';
                                renderTree(container, tree);
                            }
                        });
                    } else if (entry.isDirectory) {
                        const reader = entry.createReader();
                        reader.readEntries(entries => {
                            entries.forEach(processEntry);
                        });
                    }
                }
                
                function countFiles(entry) {
                    if (entry.isFile) {
                        totalFiles++;
                    } else if (entry.isDirectory) {
                        const reader = entry.createReader();
                        reader.readEntries(entries => {
                            entries.forEach(countFiles);
                        });
                    }
                }
                
                for (let i = 0; i < items.length; i++) {
                    const entry = items[i].webkitGetAsEntry();
                    if (entry) {
                        countFiles(entry);
                        processEntry(entry);
                    }
                }
            }
        });
        
        // Add button for manual folder selection
        const selectButton = document.createElement('button');
        selectButton.innerHTML = '<i class="fas fa-folder-open"></i> Select Course Folder';
        selectButton.style.margin = '1rem';
        document.getElementById('fileTree').before(selectButton);
        
        selectButton.onclick = () => {
            fileInput.click();
        };
        
        fileInput.onchange = (e) => {
            const files = Array.from(e.target.files);
            const tree = createFileTree(files);
            const container = document.getElementById('fileTree');
            container.innerHTML = '';
            renderTree(container, tree);
        };

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.target.tagName === 'INPUT') return;
            
            switch(e.key) {
                case ' ':
                    e.preventDefault();
                    const player = document.getElementById('player');
                    if (player) {
                        player.paused ? player.play() : player.pause();
                    }
                    break;
                case 'ArrowLeft':
                    document.getElementById('prev').click();
                    break;
                case 'ArrowRight':
                    document.getElementById('next').click();
                    break;
                case 'f':
                    document.getElementById('fullscreen').click();
                    break;
            }
        });
        /* Update createFileTree function to sort by number prefix */
        function createFileTree(files) {
            const tree = {};
            files.forEach(file => {
                const parts = file.webkitRelativePath.split('/');
                let current = tree;
                parts.forEach((part, i) => {
                    if (i === parts.length - 1) {
                        if (part.match(/\.(mp4|webm|pdf|html)$/i)) {
                            current[part] = file;
                        }
                    } else {
                        current[part] = current[part] || {};
                        current = current[part];
                    }
                });
            });

            // Sort function to handle numeric prefixes
            const sortByPrefix = (a, b) => {
                const numA = parseInt(a.match(/^(\d+)/)?.[1] || '0');
                const numB = parseInt(b.match(/^(\d+)/)?.[1] || '0');
                return numA - numB;
            };

            // Recursively sort the tree
            const sortTree = (obj) => {
                const sorted = {};
                Object.keys(obj)
                    .sort(sortByPrefix)
                    .forEach(key => {
                        sorted[key] = obj[key] instanceof File ? obj[key] : sortTree(obj[key]);
                    });
                return sorted;
            };

            return sortTree(tree);
        }

        function initResizableSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const handle = document.createElement('div');
            handle.className = 'resize-handle';
            sidebar.appendChild(handle);
        
            const toggle = document.createElement('div');
            toggle.className = 'sidebar-toggle';
            toggle.innerHTML = '<i class="fas fa-chevron-left"></i>';
            sidebar.appendChild(toggle);
        
            let isResizing = false;
            let lastWidth = parseInt(localStorage.getItem('sidebarWidth')) || 300;
            sidebar.style.width = lastWidth + 'px';
        
            let isMinimized = false;
            toggle.onclick = () => {
                isMinimized = !isMinimized;
                sidebar.style.width = isMinimized ? '50px' : lastWidth + 'px';
                toggle.innerHTML = `<i class="fas fa-chevron-${isMinimized ? 'right' : 'left'}"></i>`;
                document.querySelectorAll('.folder-content, .file span, .folder-header span, .settings, .search-container')
                    .forEach(el => el.style.display = isMinimized ? 'none' : '');
            };
        
            handle.onmousedown = (e) => {
                isResizing = true;
                document.body.style.cursor = 'col-resize';
                e.preventDefault();
            };
        
            document.onmousemove = (e) => {
                if (!isResizing) return;
                
                const newWidth = e.clientX;
                if (newWidth > 50 && newWidth < 800) {
                    sidebar.style.width = newWidth + 'px';
                    lastWidth = newWidth;
                    localStorage.setItem('sidebarWidth', newWidth);
                }
            };
        
            document.onmouseup = () => {
                isResizing = false;
                document.body.style.cursor = '';
            };
        }
        
        // Call after DOM is loaded
        initResizableSidebar();



    </script>
</body>
</html>
